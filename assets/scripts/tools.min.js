let noteConfig={fontSize:"",wordWrap:!1};const toolButtons=[...document.querySelectorAll(".__tools ._tool")],[cutButton,copyButton,pasteButton,deleteButton,wrapButton,selectAllButton,zoomInButton,zoomOutButton,downloadButton]=toolButtons,deleteNoteButton=document.querySelector(".delete-note_"),confirmDeleteButton=document.querySelector(".confirm-delete_");function toolMessage(e){document.querySelector(".action-message_").innerText=e,document.querySelector(".action-message_").style.opacity=1,setTimeout(()=>document.querySelector(".action-message_").style.opacity=0,250)}deleteNoteButton.addEventListener("click",()=>{"false"==deleteNoteButton.dataset.showConfirm?(deleteNoteButton.dataset.showConfirm="true",confirmDeleteButton.tabIndex=0):(deleteNoteButton.dataset.showConfirm="false",confirmDeleteButton.tabIndex=-1)}),confirmDeleteButton.addEventListener("click",()=>{let e=document.querySelector("[data-open='true']");notes.forEach((t,o)=>{if(t.id==e.dataset.id&&document.querySelectorAll(".__tabs ._tab:not(._tab-tools)").length>1){notes.splice(o,1),e.remove();let l=document.querySelectorAll(".__tabs ._tab:not(._tab-tools)")[o];void 0==l&&(l=document.querySelectorAll(".__tabs ._tab:not(._tab-tools)")[o-1]||document.querySelectorAll(".__tabs ._tab:not(._tab-tools)")[0]),l.click(),deleteNoteButton.dataset.showConfirm="false",confirmDeleteButton.tabIndex=-1,deleteNoteButton.focus(),toolMessage("Deleted..."),saveNote()}})}),cutButton.addEventListener("click",()=>{let e=noteBody.selectionStart,t=noteBody.selectionEnd;e!==t&&(navigator.clipboard.writeText(noteBody.value.substring(e,t)),noteBody.value=noteBody.value.slice(0,e)+noteBody.value.slice(t),toolMessage("Cutted..."),saveNote()),noteBody.select(),noteBody.setSelectionRange(e,e)}),copyButton.addEventListener("click",()=>{let e=noteBody.selectionStart,t=noteBody.selectionEnd;e!==t&&(navigator.clipboard.writeText(noteBody.value.substring(e,t)),toolMessage("Copied...")),noteBody.select(),noteBody.setSelectionRange(e,t)}),pasteButton.addEventListener("click",()=>{navigator.clipboard.readText().then(e=>{let t=noteBody.selectionStart,o=noteBody.selectionEnd;noteBody.select(),noteBody.setSelectionRange(t,o),t==o||t-o>-5?noteBody.value=noteBody.value.slice(0,t)+e+noteBody.value.slice(o):noteBody.value=noteBody.value.replace(noteBody.value.substring(t,o),e),noteBody.select(),noteBody.setSelectionRange(t+e.length,t+e.length),toolMessage("Pasted..."),saveNote()})}),deleteButton.addEventListener("click",()=>{let e=noteBody.selectionStart,t=noteBody.selectionEnd;e!==t&&(noteBody.value=noteBody.value.slice(0,e)+noteBody.value.slice(t),toolMessage("Deleted..."),saveNote()),noteBody.select(),noteBody.setSelectionRange(e,e)}),wrapButton.addEventListener("click",()=>{"false"==noteBody.dataset.enableWrap?(noteBody.dataset.enableWrap="true",wrapButton.dataset.enableWrap="true",noteConfig.wordWrap=!0):(noteBody.dataset.enableWrap="false",wrapButton.dataset.enableWrap="false",noteConfig.wordWrap=!1),localStorage.setItem("Note Config",JSON.stringify(noteConfig))}),selectAllButton.addEventListener("click",()=>{noteBody.select(),noteBody.setSelectionRange(0,99999),toolMessage("Selected...")}),zoomInButton.addEventListener("click",()=>{let e=parseFloat(getComputedStyle(noteBody).fontSize.replace("px",""))/getDefaultFontSize();e>=1.869||(noteBody.style.fontSize=`calc(${e}rem + 0.1rem)`,noteConfig.fontSize=e+.1,localStorage.setItem("Note Config",JSON.stringify(noteConfig)))}),zoomOutButton.addEventListener("click",()=>{let e=parseFloat(getComputedStyle(noteBody).fontSize.replace("px",""))/getDefaultFontSize();e<=.469||(noteBody.style.fontSize=`calc(${e}rem - 0.1rem)`,noteConfig.fontSize=e-.1,localStorage.setItem("Note Config",JSON.stringify(noteConfig)))}),downloadButton.addEventListener("click",()=>{let e=document.querySelector("[data-open='true']");notes.forEach((t,o)=>{if(t.id==e.dataset.id){let l=t.title,n=t.content,a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(n)),a.setAttribute("download",l),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}})});const getDefaultFontSize=()=>{let e=document.createElement("div");e.style.width="1rem",e.style.display="none",document.body.append(e);let t=window.getComputedStyle(e).getPropertyValue("width").match(/\d+/);if(e.remove(),!t||t.length<1)return null;let o=Number(t[0]);return isNaN(o)?null:o};function debounce(e,t=250){let o;return(...l)=>{clearTimeout(o),o=setTimeout(()=>{e.apply(this,l)},t)}}const debouncedsaveNote=debounce(saveNote),debouncedtoolMessage=debounce(toolMessage);